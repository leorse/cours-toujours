{% extends "base.html" %}

{% block title %}Accueil - Parcours{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 3rem;">
    <h1
        style="font-size: 3.5rem; margin-bottom: 0.5rem; color: var(--primary-dark); -webkit-text-stroke: 1px var(--text); filter: drop-shadow(4px 4px 0px rgba(0,0,0,0.1));">
        Qui apprend aujourd'hui ?
    </h1>
    <p style="font-weight: 600; color: var(--text-muted); font-size: 1.2rem;">Sélectionnez votre profil pour continuer
    </p>
</div>

<div class="profile-grid">
    {% for user in users %}
    <form action="/login" method="post" class="glass profile-card animate-fade-in"
        style="animation-delay: {{ loop.index0 * 100 }}ms" onclick="this.submit()">
        <input type="hidden" name="user_id" value="{{ user.id }}">
        <div class="profile-avatar">{{ user.username[0].upper() }}</div>
        <h2>{{ user.username }}</h2>
        <p class="text-muted">Niveau {{ (user.total_xp // 100) + 1 }}</p>
    </form>
    {% endfor %}

    <!-- New Profile Card -->
    <div class="glass profile-card animate-fade-in" style="animation-delay: {{ users|length * 100 }}ms"
        onclick="document.getElementById('new-profile-form').style.display = 'flex'">
        <div class="profile-avatar"
            style="background: #fff; border: 3px dashed var(--text); color: var(--text); box-shadow: none;">
            +
        </div>
        <h2>Nouveau Profil</h2>
    </div>
</div>

<!-- Modal for New Profile (Simple implementation) -->
<div id="new-profile-form"
    style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 100;">
    <form action="/users/" method="post" class="glass-panel" style="min-width: 300px; text-align: center;">
        <h2 style="margin-bottom: 1.5rem;">Créer un profil</h2>
        <input type="text" name="username" placeholder="Votre nom" required
            style="width: 100%; padding: 1rem; margin-bottom: 1.5rem; background: #fff; border: 3px solid var(--text); color: var(--text); border-radius: 1rem; font-family: inherit; font-weight: 600;">
        <div style="display: flex; gap: 1rem; justify-content: center;">
            <button type="button" class="btn-secondary"
                onclick="document.getElementById('new-profile-form').style.display = 'none'">Annuler</button>
            <button type="submit" class="btn-primary">Créer</button>
        </div>
    </form>
</div>
{% endblock %}